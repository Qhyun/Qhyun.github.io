import{af as ve,c as le,ag as Pe,D as fe,d as P,z as Q,v as Y,A as ee,J as ne,r as E,aW as ye,aU as je,bp as Fe,W as Ue,bq as _e,Q as T,T as J,br as He,a3 as z,a4 as Ne,a9 as ke,o as w,f as V,g as S,n as H,w as O,a7 as Re,K as L,a6 as I,M as X,h as x,a5 as We,F as R,j as te,aB as De,ai as Oe,ac as Ye,az as Se,a0 as Te,bh as Je,bs as Qe,U as $,aZ as Ze,am as Ge,e as B,bg as Xe,L as et,t as tt,a2 as Ve,i as U,R as _}from"./index-135bdec9.js";import"./input-d180b654.js";/* empty css            */import{a as ue,E as Ce,s as nt}from"./select-607d6784.js";import{E as ot,p as he,i as at}from"./checkbox-45fa328a.js";import{E as dt}from"./card-41d291eb.js";import{U as ge}from"./event-9519ab40.js";import"./index-10c0ebab.js";import"./validator-efde276e.js";import"./_Uint8Array-0c022d17.js";const W="$treeNodeId",Ae=function(e,t){!t||t[W]||Object.defineProperty(t,W,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},we=function(e,t){return e?t[e]:t[W]},me=(e,t,o)=>{const a=e.value.currentNode;o();const n=e.value.currentNode;a!==n&&t("current-change",n?n.data:null,n)},be=e=>{let t=!0,o=!0,a=!0;for(let n=0,d=e.length;n<d;n++){const s=e[n];(s.checked!==!0||s.indeterminate)&&(t=!1,s.disabled||(a=!1)),(s.checked!==!1||s.indeterminate)&&(o=!1)}return{all:t,none:o,allWithoutDisable:a,half:!t&&!o}},se=function(e){if(e.childNodes.length===0||e.loading)return;const{all:t,none:o,half:a}=be(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):a?(e.checked=!1,e.indeterminate=!0):o&&(e.checked=!1,e.indeterminate=!1);const n=e.parent;!n||n.level===0||e.store.checkStrictly||se(n)},de=function(e,t){const o=e.store.props,a=e.data||{},n=o[t];if(typeof n=="function")return n(a,e);if(typeof n=="string")return a[n];if(typeof n>"u"){const d=a[t];return d===void 0?"":d}};let lt=0;class q{constructor(t){this.id=lt++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const o in t)ve(t,o)&&(this[o]=t[o]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const t=this.store;if(!t)throw new Error("[Node]store is required!");t.registerNode(this);const o=t.props;if(o&&typeof o.isLeaf<"u"){const d=de(this,"isLeaf");typeof d=="boolean"&&(this.isLeafByUser=d)}if(t.lazy!==!0&&this.data?(this.setData(this.data),t.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&t.lazy&&t.defaultExpandAll&&this.expand(),Array.isArray(this.data)||Ae(this,this.data),!this.data)return;const a=t.defaultExpandedKeys,n=t.key;n&&a&&a.includes(this.key)&&this.expand(null,t.autoExpandParent),n&&t.currentNodeKey!==void 0&&this.key===t.currentNodeKey&&(t.currentNode=this,t.currentNode.isCurrent=!0),t.lazy&&t._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(t){Array.isArray(t)||Ae(this,t),this.data=t,this.childNodes=[];let o;this.level===0&&Array.isArray(this.data)?o=this.data:o=de(this,"children")||[];for(let a=0,n=o.length;a<n;a++)this.insertChild({data:o[a]})}get label(){return de(this,"label")}get key(){const t=this.store.key;return this.data?this.data[t]:null}get disabled(){return de(this,"disabled")}get nextSibling(){const t=this.parent;if(t){const o=t.childNodes.indexOf(this);if(o>-1)return t.childNodes[o+1]}return null}get previousSibling(){const t=this.parent;if(t){const o=t.childNodes.indexOf(this);if(o>-1)return o>0?t.childNodes[o-1]:null}return null}contains(t,o=!0){return(this.childNodes||[]).some(a=>a===t||o&&a.contains(t))}remove(){const t=this.parent;t&&t.removeChild(this)}insertChild(t,o,a){if(!t)throw new Error("InsertChild error: child is required.");if(!(t instanceof q)){if(!a){const n=this.getChildren(!0);n.includes(t.data)||(typeof o>"u"||o<0?n.push(t.data):n.splice(o,0,t.data))}Object.assign(t,{parent:this,store:this.store}),t=le(new q(t)),t instanceof q&&t.initialize()}t.level=this.level+1,typeof o>"u"||o<0?this.childNodes.push(t):this.childNodes.splice(o,0,t),this.updateLeafState()}insertBefore(t,o){let a;o&&(a=this.childNodes.indexOf(o)),this.insertChild(t,a)}insertAfter(t,o){let a;o&&(a=this.childNodes.indexOf(o),a!==-1&&(a+=1)),this.insertChild(t,a)}removeChild(t){const o=this.getChildren()||[],a=o.indexOf(t.data);a>-1&&o.splice(a,1);const n=this.childNodes.indexOf(t);n>-1&&(this.store&&this.store.deregisterNode(t),t.parent=null,this.childNodes.splice(n,1)),this.updateLeafState()}removeChildByData(t){let o=null;for(let a=0;a<this.childNodes.length;a++)if(this.childNodes[a].data===t){o=this.childNodes[a];break}o&&this.removeChild(o)}expand(t,o){const a=()=>{if(o){let n=this.parent;for(;n.level>0;)n.expanded=!0,n=n.parent}this.expanded=!0,t&&t(),this.childNodes.forEach(n=>{n.canFocus=!0})};this.shouldLoadData()?this.loadData(n=>{Array.isArray(n)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||se(this),a())}):a()}doCreateChildren(t,o={}){t.forEach(a=>{this.insertChild(Object.assign({data:a},o),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(t=>{t.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(this.store.lazy===!0&&this.loaded!==!0&&typeof this.isLeafByUser<"u"){this.isLeaf=this.isLeafByUser;return}const t=this.childNodes;if(!this.store.lazy||this.store.lazy===!0&&this.loaded===!0){this.isLeaf=!t||t.length===0;return}this.isLeaf=!1}setChecked(t,o,a,n){if(this.indeterminate=t==="half",this.checked=t===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:s,allWithoutDisable:r}=be(this.childNodes);!this.isLeaf&&!s&&r&&(this.checked=!1,t=!1);const c=()=>{if(o){const v=this.childNodes;for(let l=0,i=v.length;l<i;l++){const y=v[l];n=n||t!==!1;const u=y.disabled?y.checked:n;y.setChecked(u,o,!0,n)}const{half:f,all:h}=be(v);h||(this.checked=h,this.indeterminate=f)}};if(this.shouldLoadData()){this.loadData(()=>{c(),se(this)},{checked:t!==!1});return}else c()}const d=this.parent;!d||d.level===0||a||se(d)}getChildren(t=!1){if(this.level===0)return this.data;const o=this.data;if(!o)return null;const a=this.store.props;let n="children";return a&&(n=a.children||"children"),o[n]===void 0&&(o[n]=null),t&&!o[n]&&(o[n]=[]),o[n]}updateChildren(){const t=this.getChildren()||[],o=this.childNodes.map(d=>d.data),a={},n=[];t.forEach((d,s)=>{const r=d[W];!!r&&o.findIndex(v=>v[W]===r)>=0?a[r]={index:s,data:d}:n.push({index:s,data:d})}),this.store.lazy||o.forEach(d=>{a[d[W]]||this.removeChildByData(d)}),n.forEach(({index:d,data:s})=>{this.insertChild({data:s},d)}),this.updateLeafState()}loadData(t,o={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(o).length)){this.loading=!0;const a=n=>{this.childNodes=[],this.doCreateChildren(n,o),this.loaded=!0,this.loading=!1,this.updateLeafState(),t&&t.call(this,n)};this.store.load(this,a)}else t&&t.call(this)}}class st{constructor(t){this.currentNode=null,this.currentNodeKey=null;for(const o in t)ve(t,o)&&(this[o]=t[o]);this.nodesMap={}}initialize(){if(this.root=new q({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){const t=this.load;t(this.root,o=>{this.root.doCreateChildren(o),this._initDefaultCheckedNodes()})}else this._initDefaultCheckedNodes()}filter(t){const o=this.filterNodeMethod,a=this.lazy,n=function(d){const s=d.root?d.root.childNodes:d.childNodes;if(s.forEach(r=>{r.visible=o.call(r,t,r.data,r),n(r)}),!d.visible&&s.length){let r=!0;r=!s.some(c=>c.visible),d.root?d.root.visible=r===!1:d.visible=r===!1}t&&d.visible&&!d.isLeaf&&!a&&d.expand()};n(this)}setData(t){t!==this.root.data?(this.root.setData(t),this._initDefaultCheckedNodes()):this.root.updateChildren()}getNode(t){if(t instanceof q)return t;const o=Pe(t)?we(this.key,t):t;return this.nodesMap[o]||null}insertBefore(t,o){const a=this.getNode(o);a.parent.insertBefore({data:t},a)}insertAfter(t,o){const a=this.getNode(o);a.parent.insertAfter({data:t},a)}remove(t){const o=this.getNode(t);o&&o.parent&&(o===this.currentNode&&(this.currentNode=null),o.parent.removeChild(o))}append(t,o){const a=o?this.getNode(o):this.root;a&&a.insertChild({data:t})}_initDefaultCheckedNodes(){const t=this.defaultCheckedKeys||[],o=this.nodesMap;t.forEach(a=>{const n=o[a];n&&n.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(t){(this.defaultCheckedKeys||[]).includes(t.key)&&t.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(t){t!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=t,this._initDefaultCheckedNodes())}registerNode(t){const o=this.key;!t||!t.data||(o?t.key!==void 0&&(this.nodesMap[t.key]=t):this.nodesMap[t.id]=t)}deregisterNode(t){!this.key||!t||!t.data||(t.childNodes.forEach(a=>{this.deregisterNode(a)}),delete this.nodesMap[t.key])}getCheckedNodes(t=!1,o=!1){const a=[],n=function(d){(d.root?d.root.childNodes:d.childNodes).forEach(r=>{(r.checked||o&&r.indeterminate)&&(!t||t&&r.isLeaf)&&a.push(r.data),n(r)})};return n(this),a}getCheckedKeys(t=!1){return this.getCheckedNodes(t).map(o=>(o||{})[this.key])}getHalfCheckedNodes(){const t=[],o=function(a){(a.root?a.root.childNodes:a.childNodes).forEach(d=>{d.indeterminate&&t.push(d.data),o(d)})};return o(this),t}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(t=>(t||{})[this.key])}_getAllNodes(){const t=[],o=this.nodesMap;for(const a in o)ve(o,a)&&t.push(o[a]);return t}updateChildren(t,o){const a=this.nodesMap[t];if(!a)return;const n=a.childNodes;for(let d=n.length-1;d>=0;d--){const s=n[d];this.remove(s.data)}for(let d=0,s=o.length;d<s;d++){const r=o[d];this.append(r,a.data)}}_setCheckedKeys(t,o=!1,a){const n=this._getAllNodes().sort((r,c)=>c.level-r.level),d=Object.create(null),s=Object.keys(a);n.forEach(r=>r.setChecked(!1,!1));for(let r=0,c=n.length;r<c;r++){const v=n[r],f=v.data[t].toString();if(!s.includes(f)){v.checked&&!d[f]&&v.setChecked(!1,!1);continue}let l=v.parent;for(;l&&l.level>0;)d[l.data[t]]=!0,l=l.parent;if(v.isLeaf||this.checkStrictly){v.setChecked(!0,!1);continue}if(v.setChecked(!0,!0),o){v.setChecked(!1,!1);const i=function(y){y.childNodes.forEach(k=>{k.isLeaf||k.setChecked(!1,!1),i(k)})};i(v)}}}setCheckedNodes(t,o=!1){const a=this.key,n={};t.forEach(d=>{n[(d||{})[a]]=!0}),this._setCheckedKeys(a,o,n)}setCheckedKeys(t,o=!1){this.defaultCheckedKeys=t;const a=this.key,n={};t.forEach(d=>{n[d]=!0}),this._setCheckedKeys(a,o,n)}setDefaultExpandedKeys(t){t=t||[],this.defaultExpandedKeys=t,t.forEach(o=>{const a=this.getNode(o);a&&a.expand(null,this.autoExpandParent)})}setChecked(t,o,a){const n=this.getNode(t);n&&n.setChecked(!!o,a)}getCurrentNode(){return this.currentNode}setCurrentNode(t){const o=this.currentNode;o&&(o.isCurrent=!1),this.currentNode=t,this.currentNode.isCurrent=!0}setUserCurrentNode(t,o=!0){const a=t[this.key],n=this.nodesMap[a];this.setCurrentNode(n),o&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(t,o=!0){if(t==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const a=this.getNode(t);a&&(this.setCurrentNode(a),o&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const rt=P({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=Q("tree"),o=Y("NodeInstance"),a=Y("RootTree");return()=>{const n=e.node,{data:d,store:s}=n;return e.renderContent?e.renderContent(ee,{_self:o,node:n,data:d,store:s}):a.ctx.slots.default?a.ctx.slots.default({node:n,data:d}):ee("span",{class:t.be("node","label")},[n.label])}}});var it=fe(rt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree/src/tree-node-content.vue"]]);function Le(e){const t=Y("TreeNodeMap",null),o={treeNodeExpand:a=>{e.node!==a&&e.node.collapse()},children:[]};return t&&t.children.push(o),ne("TreeNodeMap",o),{broadcastExpanded:a=>{if(e.accordion)for(const n of o.children)n.treeNodeExpand(a)}}}const Me=Symbol("dragEvents");function ct({props:e,ctx:t,el$:o,dropIndicator$:a,store:n}){const d=Q("tree"),s=E({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return ne(Me,{treeNodeDragStart:({event:f,treeNode:h})=>{if(typeof e.allowDrag=="function"&&!e.allowDrag(h.node))return f.preventDefault(),!1;f.dataTransfer.effectAllowed="move";try{f.dataTransfer.setData("text/plain","")}catch{}s.value.draggingNode=h,t.emit("node-drag-start",h.node,f)},treeNodeDragOver:({event:f,treeNode:h})=>{const l=h,i=s.value.dropNode;i&&i.node.id!==l.node.id&&ye(i.$el,d.is("drop-inner"));const y=s.value.draggingNode;if(!y||!l)return;let u=!0,k=!0,m=!0,b=!0;typeof e.allowDrop=="function"&&(u=e.allowDrop(y.node,l.node,"prev"),b=k=e.allowDrop(y.node,l.node,"inner"),m=e.allowDrop(y.node,l.node,"next")),f.dataTransfer.dropEffect=k||u||m?"move":"none",(u||k||m)&&(i==null?void 0:i.node.id)!==l.node.id&&(i&&t.emit("node-drag-leave",y.node,i.node,f),t.emit("node-drag-enter",y.node,l.node,f)),(u||k||m)&&(s.value.dropNode=l),l.node.nextSibling===y.node&&(m=!1),l.node.previousSibling===y.node&&(u=!1),l.node.contains(y.node,!1)&&(k=!1),(y.node===l.node||y.node.contains(l.node))&&(u=!1,k=!1,m=!1);const A=l.$el.getBoundingClientRect(),M=o.value.getBoundingClientRect();let C;const oe=u?k?.25:m?.45:1:-1,ae=m?k?.75:u?.55:0:1;let j=-9999;const g=f.clientY-A.top;g<A.height*oe?C="before":g>A.height*ae?C="after":k?C="inner":C="none";const K=l.$el.querySelector(`.${d.be("node","expand-icon")}`).getBoundingClientRect(),D=a.value;C==="before"?j=K.top-M.top:C==="after"&&(j=K.bottom-M.top),D.style.top=`${j}px`,D.style.left=`${K.right-M.left}px`,C==="inner"?je(l.$el,d.is("drop-inner")):ye(l.$el,d.is("drop-inner")),s.value.showDropIndicator=C==="before"||C==="after",s.value.allowDrop=s.value.showDropIndicator||b,s.value.dropType=C,t.emit("node-drag-over",y.node,l.node,f)},treeNodeDragEnd:f=>{const{draggingNode:h,dropType:l,dropNode:i}=s.value;if(f.preventDefault(),f.dataTransfer.dropEffect="move",h&&i){const y={data:h.node.data};l!=="none"&&h.node.remove(),l==="before"?i.node.parent.insertBefore(y,i.node):l==="after"?i.node.parent.insertAfter(y,i.node):l==="inner"&&i.node.insertChild(y),l!=="none"&&n.value.registerNode(y),ye(i.$el,d.is("drop-inner")),t.emit("node-drag-end",h.node,i.node,l,f),l!=="none"&&t.emit("node-drop",h.node,i.node,l,f)}h&&!i&&t.emit("node-drag-end",h.node,null,l,f),s.value.showDropIndicator=!1,s.value.draggingNode=null,s.value.dropNode=null,s.value.allowDrop=!0}}),{dragState:s}}const ut=P({name:"ElTreeNode",components:{ElCollapseTransition:Fe,ElCheckbox:ot,NodeContent:it,ElIcon:Ue,Loading:_e},props:{node:{type:q,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const o=Q("tree"),{broadcastExpanded:a}=Le(e),n=Y("RootTree"),d=E(!1),s=E(!1),r=E(null),c=E(null),v=E(null),f=Y(Me),h=De();ne("NodeInstance",h),e.node.expanded&&(d.value=!0,s.value=!0);const l=n.props.children||"children";T(()=>{const g=e.node.data[l];return g&&[...g]},()=>{e.node.updateChildren()}),T(()=>e.node.indeterminate,g=>{u(e.node.checked,g)}),T(()=>e.node.checked,g=>{u(g,e.node.indeterminate)}),T(()=>e.node.expanded,g=>{J(()=>d.value=g),g&&(s.value=!0)});const i=g=>we(n.props.nodeKey,g.data),y=g=>{const K=e.props.class;if(!K)return{};let D;if(Oe(K)){const{data:pe}=g;D=K(pe,g)}else D=K;return Ye(D)?{[D]:!0}:D},u=(g,K)=>{(r.value!==g||c.value!==K)&&n.ctx.emit("check-change",e.node.data,g,K),r.value=g,c.value=K},k=g=>{me(n.store,n.ctx.emit,()=>n.store.value.setCurrentNode(e.node)),n.currentNode.value=e.node,n.props.expandOnClickNode&&b(),n.props.checkOnClickNode&&!e.node.disabled&&A(null,{target:{checked:!e.node.checked}}),n.ctx.emit("node-click",e.node.data,e.node,h,g)},m=g=>{n.instance.vnode.props.onNodeContextmenu&&(g.stopPropagation(),g.preventDefault()),n.ctx.emit("node-contextmenu",g,e.node.data,e.node,h)},b=()=>{e.node.isLeaf||(d.value?(n.ctx.emit("node-collapse",e.node.data,e.node,h),e.node.collapse()):(e.node.expand(),t.emit("node-expand",e.node.data,e.node,h)))},A=(g,K)=>{e.node.setChecked(K.target.checked,!n.props.checkStrictly),J(()=>{const D=n.store.value;n.ctx.emit("check",e.node.data,{checkedNodes:D.getCheckedNodes(),checkedKeys:D.getCheckedKeys(),halfCheckedNodes:D.getHalfCheckedNodes(),halfCheckedKeys:D.getHalfCheckedKeys()})})};return{ns:o,node$:v,tree:n,expanded:d,childNodeRendered:s,oldChecked:r,oldIndeterminate:c,getNodeKey:i,getNodeClass:y,handleSelectChange:u,handleClick:k,handleContextMenu:m,handleExpandIconClick:b,handleCheckChange:A,handleChildNodeExpand:(g,K,D)=>{a(K),n.ctx.emit("node-expand",g,K,D)},handleDragStart:g=>{n.props.draggable&&f.treeNodeDragStart({event:g,treeNode:e})},handleDragOver:g=>{g.preventDefault(),n.props.draggable&&f.treeNodeDragOver({event:g,treeNode:{$el:v.value,node:e.node}})},handleDrop:g=>{g.preventDefault()},handleDragEnd:g=>{n.props.draggable&&f.treeNodeDragEnd(g)},CaretRight:He}}}),ht=["aria-expanded","aria-disabled","aria-checked","draggable","data-key"],ft=["aria-expanded"];function pt(e,t,o,a,n,d){const s=z("el-icon"),r=z("el-checkbox"),c=z("loading"),v=z("node-content"),f=z("el-tree-node"),h=z("el-collapse-transition");return Ne((w(),V("div",{ref:"node$",class:L([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:t[1]||(t[1]=I((...l)=>e.handleClick&&e.handleClick(...l),["stop"])),onContextmenu:t[2]||(t[2]=(...l)=>e.handleContextMenu&&e.handleContextMenu(...l)),onDragstart:t[3]||(t[3]=I((...l)=>e.handleDragStart&&e.handleDragStart(...l),["stop"])),onDragover:t[4]||(t[4]=I((...l)=>e.handleDragOver&&e.handleDragOver(...l),["stop"])),onDragend:t[5]||(t[5]=I((...l)=>e.handleDragEnd&&e.handleDragEnd(...l),["stop"])),onDrop:t[6]||(t[6]=I((...l)=>e.handleDrop&&e.handleDrop(...l),["stop"]))},[S("div",{class:L(e.ns.be("node","content")),style:We({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(w(),H(s,{key:0,class:L([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:I(e.handleExpandIconClick,["stop"])},{default:O(()=>[(w(),H(Re(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):X("v-if",!0),e.showCheckbox?(w(),H(r,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:t[0]||(t[0]=I(()=>{},["stop"])),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onChange"])):X("v-if",!0),e.node.loading?(w(),H(s,{key:2,class:L([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:O(()=>[x(c)]),_:1},8,["class"])):X("v-if",!0),x(v,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),x(h,null,{default:O(()=>[!e.renderAfterExpand||e.childNodeRendered?Ne((w(),V("div",{key:0,class:L(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(w(!0),V(R,null,te(e.node.childNodes,l=>(w(),H(f,{key:e.getNodeKey(l),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:l,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,ft)),[[ke,e.expanded]]):X("v-if",!0)]),_:1})],42,ht)),[[ke,e.node.visible]])}var yt=fe(ut,[["render",pt],["__file","/home/runner/work/element-plus/element-plus/packages/components/tree/src/tree-node.vue"]]);function gt({el$:e},t){const o=Q("tree"),a=Se([]),n=Se([]);Te(()=>{s()}),Je(()=>{a.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),n.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))}),T(n,r=>{r.forEach(c=>{c.setAttribute("tabindex","-1")})}),Qe(e,"keydown",r=>{const c=r.target;if(!c.className.includes(o.b("node")))return;const v=r.code;a.value=Array.from(e.value.querySelectorAll(`.${o.is("focusable")}[role=treeitem]`));const f=a.value.indexOf(c);let h;if([$.up,$.down].includes(v)){if(r.preventDefault(),v===$.up){h=f===-1?0:f!==0?f-1:a.value.length-1;const i=h;for(;!t.value.getNode(a.value[h].dataset.key).canFocus;){if(h--,h===i){h=-1;break}h<0&&(h=a.value.length-1)}}else{h=f===-1?0:f<a.value.length-1?f+1:0;const i=h;for(;!t.value.getNode(a.value[h].dataset.key).canFocus;){if(h++,h===i){h=-1;break}h>=a.value.length&&(h=0)}}h!==-1&&a.value[h].focus()}[$.left,$.right].includes(v)&&(r.preventDefault(),c.click());const l=c.querySelector('[type="checkbox"]');[$.enter,$.space].includes(v)&&l&&(r.preventDefault(),l.click())});const s=()=>{var r;a.value=Array.from(e.value.querySelectorAll(`.${o.is("focusable")}[role=treeitem]`)),n.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const c=e.value.querySelectorAll(`.${o.is("checked")}[role=treeitem]`);if(c.length){c[0].setAttribute("tabindex","0");return}(r=a.value[0])==null||r.setAttribute("tabindex","0")}}const vt=P({name:"ElTree",components:{ElTreeNode:yt},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:Ze}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const{t:o}=Ge(),a=Q("tree"),n=E(new st({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));n.value.initialize();const d=E(n.value.root),s=E(null),r=E(null),c=E(null),{broadcastExpanded:v}=Le(e),{dragState:f}=ct({props:e,ctx:t,el$:r,dropIndicator$:c,store:n});gt({el$:r},n);const h=B(()=>{const{childNodes:p}=d.value;return!p||p.length===0||p.every(({visible:N})=>!N)});T(()=>e.currentNodeKey,p=>{n.value.setCurrentNodeKey(p)}),T(()=>e.defaultCheckedKeys,p=>{n.value.setDefaultCheckedKey(p)}),T(()=>e.defaultExpandedKeys,p=>{n.value.setDefaultExpandedKeys(p)}),T(()=>e.data,p=>{n.value.setData(p)},{deep:!0}),T(()=>e.checkStrictly,p=>{n.value.checkStrictly=p});const l=p=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");n.value.filter(p)},i=p=>we(e.nodeKey,p.data),y=p=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const N=n.value.getNode(p);if(!N)return[];const F=[N.data];let Z=N.parent;for(;Z&&Z!==d.value;)F.push(Z.data),Z=Z.parent;return F.reverse()},u=(p,N)=>n.value.getCheckedNodes(p,N),k=p=>n.value.getCheckedKeys(p),m=()=>{const p=n.value.getCurrentNode();return p?p.data:null},b=()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const p=m();return p?p[e.nodeKey]:null},A=(p,N)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");n.value.setCheckedNodes(p,N)},M=(p,N)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");n.value.setCheckedKeys(p,N)},C=(p,N,F)=>{n.value.setChecked(p,N,F)},oe=()=>n.value.getHalfCheckedNodes(),ae=()=>n.value.getHalfCheckedKeys(),j=(p,N=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");me(n,t.emit,()=>n.value.setUserCurrentNode(p,N))},g=(p,N=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");me(n,t.emit,()=>n.value.setCurrentNodeKey(p,N))},K=p=>n.value.getNode(p),D=p=>{n.value.remove(p)},pe=(p,N)=>{n.value.append(p,N)},Ie=(p,N)=>{n.value.insertBefore(p,N)},$e=(p,N)=>{n.value.insertAfter(p,N)},ze=(p,N,F)=>{v(N),t.emit("node-expand",p,N,F)},qe=(p,N)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");n.value.updateChildren(p,N)};return ne("RootTree",{ctx:t,props:e,store:n,root:d,currentNode:s,instance:De()}),ne(Xe,void 0),{ns:a,store:n,root:d,currentNode:s,dragState:f,el$:r,dropIndicator$:c,isEmpty:h,filter:l,getNodeKey:i,getNodePath:y,getCheckedNodes:u,getCheckedKeys:k,getCurrentNode:m,getCurrentKey:b,setCheckedNodes:A,setCheckedKeys:M,setChecked:C,getHalfCheckedNodes:oe,getHalfCheckedKeys:ae,setCurrentNode:j,setCurrentKey:g,t:o,getNode:K,remove:D,append:pe,insertBefore:Ie,insertAfter:$e,handleNodeExpand:ze,updateKeyChildren:qe}}});function Nt(e,t,o,a,n,d){const s=z("el-tree-node");return w(),V("div",{ref:"el$",class:L([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner",e.dragState.dropType==="inner"),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(w(!0),V(R,null,te(e.root.childNodes,r=>(w(),H(s,{key:e.getNodeKey(r),node:r,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),e.isEmpty?(w(),V("div",{key:0,class:L(e.ns.e("empty-block"))},[et(e.$slots,"empty",{},()=>{var r;return[S("span",{class:L(e.ns.e("empty-text"))},tt((r=e.emptyText)!=null?r:e.t("el.tree.emptyText")),3)]})],2)):X("v-if",!0),Ne(S("div",{ref:"dropIndicator$",class:L(e.ns.e("drop-indicator"))},null,2),[[ke,e.dragState.showDropIndicator]])],2)}var re=fe(vt,[["render",Nt],["__file","/home/runner/work/element-plus/element-plus/packages/components/tree/src/tree.vue"]]);re.install=e=>{e.component(re.name,re)};const Ke=re,kt=(e,{attrs:t},{tree:o,key:a})=>{const n=Q("tree-select"),d={...he(Ve(e),Object.keys(ue.props)),...t,valueKey:a,popperClass:B(()=>{const s=[n.e("popper")];return e.popperClass&&s.push(e.popperClass),s.join(" ")}),filterMethod:(s="")=>{e.filterMethod&&e.filterMethod(s),J(()=>{var r;(r=o.value)==null||r.filter(s)})},onVisibleChange:s=>{var r;(r=t.onVisibleChange)==null||r.call(t,s),e.filterable&&s&&d.filterMethod()}};return d},Ct=P({extends:Ce,setup(e,t){const o=Ce.setup(e,t);delete o.selectOptionClick;const a=De().proxy;return J(()=>{o.select.cachedOptions.get(a.value)||o.select.onOptionCreate(a)}),o},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function Ee(e){return e||e===0}function xe(e){return Array.isArray(e)&&e.length}function G(e){return Array.isArray(e)?e:Ee(e)?[e]:[]}function ie(e,t,o,a,n){for(let d=0;d<e.length;d++){const s=e[d];if(t(s,d,e,n))return a?a(s,d,e,n):s;{const r=o(s);if(xe(r)){const c=ie(r,t,o,a,s);if(c)return c}}}}function Be(e,t,o,a){for(let n=0;n<e.length;n++){const d=e[n];t(d,n,e,a);const s=o(d);xe(s)&&Be(s,t,o,d)}}const mt=(e,{attrs:t,slots:o,emit:a},{select:n,tree:d,key:s})=>{T(()=>e.modelValue,()=>{e.showCheckbox&&J(()=>{const l=d.value;l&&!at(l.getCheckedKeys(),G(e.modelValue))&&l.setCheckedKeys(G(e.modelValue))})},{immediate:!0,deep:!0});const r=B(()=>({value:s.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),c=(l,i)=>{var y;const u=r.value[l];return Oe(u)?u(i,(y=d.value)==null?void 0:y.getNode(c("value",i))):i[u]},v=G(e.modelValue).map(l=>ie(e.data||[],i=>c("value",i)===l,i=>c("children",i),(i,y,u,k)=>k&&c("value",k))).filter(l=>Ee(l)),f=B(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const l=[];return Be(e.data.concat(e.cacheData),i=>{const y=c("value",i);l.push({value:y,currentLabel:c("label",i),isDisabled:c("disabled",i)})},i=>c("children",i)),l}),h=B(()=>f.value.reduce((l,i)=>({...l,[i.value]:i}),{}));return{...he(Ve(e),Object.keys(Ke.props)),...t,nodeKey:s,expandOnClickNode:B(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:B(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(v):v),renderContent:(l,{node:i,data:y,store:u})=>l(Ct,{value:c("value",y),label:c("label",y),disabled:c("disabled",y)},e.renderContent?()=>e.renderContent(l,{node:i,data:y,store:u}):o.default?()=>o.default({node:i,data:y,store:u}):void 0),filterNodeMethod:(l,i,y)=>{var u;return e.filterNodeMethod?e.filterNodeMethod(l,i,y):l?(u=c("label",i))==null?void 0:u.includes(l):!0},onNodeClick:(l,i,y)=>{var u,k,m;if((u=t.onNodeClick)==null||u.call(t,l,i,y),!(e.showCheckbox&&e.checkOnClickNode))if(!e.showCheckbox&&(e.checkStrictly||i.isLeaf)){if(!c("disabled",l)){const b=(k=n.value)==null?void 0:k.options.get(c("value",l));(m=n.value)==null||m.handleOptionSelect(b,!0)}}else e.expandOnClickNode&&y.proxy.handleExpandIconClick()},onCheck:(l,i)=>{if(!e.showCheckbox)return;const y=c("value",l),u=i.checkedKeys,k=e.multiple?G(e.modelValue).filter(b=>b in h.value&&!d.value.getNode(b)&&!u.includes(b)):[],m=u.concat(k);if(e.checkStrictly)a(ge,e.multiple?m:m.includes(y)?y:void 0);else if(e.multiple)a(ge,d.value.getCheckedKeys(!0));else{const b=ie([l],C=>!xe(c("children",C))&&!c("disabled",C),C=>c("children",C)),A=b?c("value",b):void 0,M=Ee(e.modelValue)&&!!ie([l],C=>c("value",C)===e.modelValue,C=>c("children",C));a(ge,A===e.modelValue||M?void 0:A)}J(()=>{var b;const A=G(e.modelValue);d.value.setCheckedKeys(A),(b=t.onCheck)==null||b.call(t,l,{checkedKeys:d.value.getCheckedKeys(),checkedNodes:d.value.getCheckedNodes(),halfCheckedKeys:d.value.getHalfCheckedKeys(),halfCheckedNodes:d.value.getHalfCheckedNodes()})})},cacheOptions:f}};var bt=P({props:{data:{type:Array,default:()=>[]}},setup(e){const t=Y(nt);return T(()=>e.data,()=>{var o;e.data.forEach(n=>{t.cachedOptions.has(n.value)||t.cachedOptions.set(n.value,n)});const a=((o=t.selectWrapper)==null?void 0:o.querySelectorAll("input"))||[];Array.from(a).includes(document.activeElement)||t.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const Kt=P({name:"ElTreeSelect",inheritAttrs:!1,props:{...ue.props,...Ke.props,cacheData:{type:Array,default:()=>[]}},setup(e,t){const{slots:o,expose:a}=t,n=E(),d=E(),s=B(()=>e.nodeKey||e.valueKey||"value"),r=kt(e,t,{select:n,tree:d,key:s}),{cacheOptions:c,...v}=mt(e,t,{select:n,tree:d,key:s}),f=le({});return a(f),Te(()=>{Object.assign(f,{...he(d.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...he(n.value,["focus","blur"])})}),()=>ee(ue,le({...r,ref:h=>n.value=h}),{...o,default:()=>[ee(bt,{data:c.value}),ee(Ke,le({...v,ref:h=>d.value=h}))]})}});var ce=fe(Kt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-select/src/tree-select.vue"]]);ce.install=e=>{e.component(ce.name,ce)};const Et=ce,Dt=Et;const wt={class:"m-2"},xt=S("span",null,"常规选择器(可清空选项框)",-1),St={class:"m-2"},At=S("span",null,"多选选择器",-1),Ot=S("p",null,"超出选择器自动撑开",-1),Tt=S("p",null,"鼠标悬停显示隐藏选项",-1),Vt={class:"m-2"},Lt=S("span",null,"树形选择器",-1),Mt=S("p",null,"常规树形选择器",-1),Bt=S("p",null,"选择任意级别(父子级别均可选)",-1),It=S("p",null,"多选树形选择器",-1),Wt=P({__name:"select",setup(e){const t=E(""),o=E([]),a=E([]),n=E(),d=E(),s=E(),r=[{value:"1",label:"选项一"},{value:"2",label:"选项二"},{value:"3",label:"选项三"},{value:"4",label:"选项四"}],c=[{value:"1",label:"选项1",children:[{value:"1-1",label:"选项1-1",children:[{value:"1-1-1",label:"选项1-1-1"},{value:"1-1-2",label:"选项1-1-2"}]},{value:"1-2",label:"选项1-2"},{value:"1-3",label:"选项1-3"}]},{value:"2",label:"选项2",children:[{value:"2-1",label:"选项2-1",children:[{value:"2-1-1",label:"选项2-1-1"}]},{value:"2-2",label:"选项1-2"}]}];return(v,f)=>{const h=Ce,l=ue,i=dt,y=Dt;return w(),V(R,null,[S("div",wt,[x(i,null,{header:O(()=>[xt]),default:O(()=>[x(l,{modelValue:U(t),"onUpdate:modelValue":f[0]||(f[0]=u=>_(t)?t.value=u:null),placeholder:"请选择",clearable:""},{default:O(()=>[(w(),V(R,null,te(r,u=>x(h,{key:u.value,value:u.value,label:u.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1})]),S("div",St,[x(i,null,{header:O(()=>[At]),default:O(()=>[Ot,x(l,{modelValue:U(o),"onUpdate:modelValue":f[1]||(f[1]=u=>_(o)?o.value=u:null),placeholder:"请选择",multiple:"",clearable:""},{default:O(()=>[(w(),V(R,null,te(r,u=>x(h,{key:u.value,value:u.value,label:u.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"]),Tt,x(l,{modelValue:U(a),"onUpdate:modelValue":f[2]||(f[2]=u=>_(a)?a.value=u:null),placeholder:"请选择",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",clearable:""},{default:O(()=>[(w(),V(R,null,te(r,u=>x(h,{key:u.value,value:u.value,label:u.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1})]),S("div",Vt,[x(i,null,{header:O(()=>[Lt]),default:O(()=>[Mt,x(y,{modelValue:U(n),"onUpdate:modelValue":f[3]||(f[3]=u=>_(n)?n.value=u:null),data:c,"render-after-expand":!1},null,8,["modelValue"]),Bt,x(y,{modelValue:U(d),"onUpdate:modelValue":f[4]||(f[4]=u=>_(d)?d.value=u:null),"check-strictly":"",data:c,"render-after-expand":!1},null,8,["modelValue"]),It,x(y,{modelValue:U(s),"onUpdate:modelValue":f[5]||(f[5]=u=>_(s)?s.value=u:null),multiple:"",data:c,"render-after-expand":!1},null,8,["modelValue"])]),_:1})])],64)}}});export{Wt as default};
